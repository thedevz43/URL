================================================================================
  v7 PRODUCTION: MULTI-INPUT CHARACTER-LEVEL CNN ARCHITECTURE
  Visual Architecture Diagram - Updated February 15, 2026
================================================================================

COMPLETE PIPELINE FLOW (v7 PRODUCTION SYSTEM):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  RAW URL INPUT                  â”‚
                              â”‚  "http://paypa1-secure.tk"      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                                                     â”‚
                   â–¼                                                     â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  URL PREPROCESSING     â”‚                        â”‚  DOMAIN EXTRACTION    â”‚
      â”‚  - Lowercase           â”‚                        â”‚  - Parse URL          â”‚
      â”‚  - Character encoding  â”‚                        â”‚  - Extract netloc     â”‚
      â”‚  - Padding to 200      â”‚                        â”‚  - Padding to 100     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                                 â”‚
                 â–¼                                                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  URL SEQUENCE          â”‚                        â”‚  DOMAIN SEQUENCE      â”‚
      â”‚  Shape: (1, 200)       â”‚                        â”‚  Shape: (1, 100)      â”‚
      â”‚  [59, 62, 62, 59, ...] â”‚                        â”‚  [59, 37, 60, 59,...] â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                                 â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                                  â”‚
                 â”‚   DUAL-INPUT NEURAL NETWORK      â”‚
                 â”‚   (Multi-Stream Architecture)    â”‚
                 â”‚                                  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

v7 NEURAL NETWORK ARCHITECTURE (MULTI-INPUT):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚            INPUT LAYERS (DUAL STREAM)           â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                                       â”‚
              â–¼                                       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  URL INPUT             â”‚              â”‚  DOMAIN INPUT           â”‚
  â”‚  Shape: (None, 200)    â”‚              â”‚  Shape: (None, 100)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â–¼                                        â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  URL EMBEDDING         â”‚              â”‚  DOMAIN EMBEDDING       â”‚
  â”‚  Vocab: 101            â”‚              â”‚  Vocab: 101             â”‚
  â”‚  Dim: 128              â”‚              â”‚  Dim: 128               â”‚
  â”‚  Output: (None,200,128)â”‚              â”‚  Output: (None,100,128) â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â”‚    URL BRANCH                          â”‚    DOMAIN BRANCH
              â”‚    â•â•â•â•â•â•â•â•â•â•â•                         â”‚    â•â•â•â•â•â•â•â•â•â•â•â•â•
              â”‚                                        â”‚
              â–¼                                        â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CONV1D (256, k=3)      â”‚              â”‚ CONV1D (128, k=3)       â”‚
  â”‚ MaxPool (2)            â”‚              â”‚ MaxPool (2)             â”‚
  â”‚ Dropout (0.3)          â”‚              â”‚ Dropout (0.3)           â”‚
  â”‚ Output: (None,99,256)  â”‚              â”‚ Output: (None,49,128)   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â”‚ Patterns: "htt", "php"                 â”‚ Patterns: "com", "net"
              â”‚                                        â”‚
              â–¼                                        â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CONV1D (128, k=5)      â”‚              â”‚ CONV1D (64, k=5)        â”‚
  â”‚ MaxPool (2)            â”‚              â”‚ MaxPool (2)             â”‚
  â”‚ Dropout (0.3)          â”‚              â”‚ Dropout (0.3)           â”‚
  â”‚ Output: (None,48,128)  â”‚              â”‚ Output: (None,23,64)    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â”‚ Patterns: "login", "admin"             â”‚ Patterns: "paypa", "googl"
              â”‚                                        â”‚
              â–¼                                        â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CONV1D (64, k=7)       â”‚              â”‚ CONV1D (32, k=7)        â”‚
  â”‚ GlobalMaxPool          â”‚              â”‚ GlobalMaxPool           â”‚
  â”‚ Dropout (0.3)          â”‚              â”‚ Dropout (0.3)           â”‚
  â”‚ Output: (None, 64)     â”‚              â”‚ Output: (None, 32)      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â”‚ Patterns: "phishing"                   â”‚ Patterns: "malware"
              â”‚                                        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CONCATENATE            â”‚
                    â”‚  Merge: 64 + 32 = 96    â”‚
                    â”‚  Output: (None, 96)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DENSE (128, ReLU)      â”‚
                    â”‚  L2 Regularization      â”‚
                    â”‚  Dropout (0.5)          â”‚
                    â”‚  Output: (None, 128)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DENSE (64, ReLU)       â”‚
                    â”‚  L2 Regularization      â”‚
                    â”‚  Dropout (0.5)          â”‚
                    â”‚  Output: (None, 64)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  OUTPUT (4, Softmax)    â”‚
                    â”‚  Classes:               â”‚
                    â”‚  - Benign               â”‚
                    â”‚  - Phishing             â”‚
                    â”‚  - Malware              â”‚
                    â”‚  - Defacement           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  RAW PROBABILITIES      â”‚
                    â”‚  [0.05, 0.88, 0.04, 0.03]â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  v7 ENHANCEMENT LAYER (POST-PROCESS) â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  4-TIER DECISION LOGIC                 â”‚
              â”‚                                        â”‚
              â”‚  max_malicious = max(phishing,         â”‚
              â”‚                      malware,          â”‚
              â”‚                      defacement)       â”‚
              â”‚                                        â”‚
              â”‚  reputation = get_domain_reputation()  â”‚
              â”‚                                        â”‚
              â”‚  TIER 1 (â‰¥93%): Always BLOCK          â”‚
              â”‚  TIER 2A (75-93%): Rep-based          â”‚
              â”‚  TIER 2B (35-75%): Elite only         â”‚
              â”‚  TIER 3 (<35%): ALLOW                 â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  FINAL PREDICTION                      â”‚
              â”‚  {                                     â”‚
              â”‚    "prediction": "phishing",           â”‚
              â”‚    "confidence": 0.88,                 â”‚
              â”‚    "risk_level": "high",              â”‚
              â”‚    "tier": "tier_1"                   â”‚
              â”‚  }                                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TOTAL PARAMETERS: 424,132 (all trainable)
MODEL SIZE: 13.3 MB
INFERENCE TIME: 40-50ms (CPU)


DATA FLOW EXAMPLE (v7 DUAL-INPUT):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

INPUT URL: "http://paypa1-secure.tk/verify/login.php?id=123"

STEP 1: Dual Preprocessing
  URL: "http://paypa1-secure.tk/verify/login.php?id=123"
    â†“
  URL Sequence (200 chars): [34, 62, 62, 59, 26, 18, 18, 59, 37, 60, ...]
  
  DOMAIN: "paypa1-secure.tk"
    â†“
  Domain Sequence (100 chars): [59, 37, 60, 59, 37, 13, 28, 54, 47, 49, ...]

STEP 2: Dual Embedding (128-dim vectors)
  URL Branch:     [[0.23, -0.45, 0.12, ...], [0.89, 0.34, -0.23, ...], ...]
  Domain Branch:  [[0.67, 0.12, -0.34, ...], [0.45, -0.22, 0.56, ...], ...]

STEP 3: Parallel Convolutional Processing
  
  URL BRANCH (focuses on full URL patterns):
  â”œâ”€ Conv1D (k=3): Detects "htt", "php", "log", "id="
  â”œâ”€ Conv1D (k=5): Detects "login", "verif", ".php?"
  â””â”€ Conv1D (k=7): Detects "verify/", "login.p"
  
  DOMAIN BRANCH (focuses on domain patterns):
  â”œâ”€ Conv1D (k=3): Detects "pay", "pa1", ".tk"
  â”œâ”€ Conv1D (k=5): Detects "paypa", "secur"
  â””â”€ Conv1D (k=7): Detects "paypa1-", "secure."

STEP 4: Global Max Pooling
  URL features:    [0.92, 0.78, 0.45, ...] â†’ 64 features
  Domain features: [0.88, 0.91, 0.67, ...] â†’ 32 features

STEP 5: Feature Concatenation
  Combined: 64 + 32 = 96 features

STEP 6: Dense Layers
  Dense(128) â†’ Dense(64) â†’ Dense(4)
  Learns complex decision boundaries

STEP 7: Softmax Output (Base Prediction)
  Probabilities:
  - Benign:      0.05 (5%)
  - Phishing:    0.91 (91%)  â† Raw Prediction
  - Malware:     0.03 (3%)
  - Defacement:  0.01 (1%)

STEP 8: v7 Enhancement (4-Tier Logic)
  max_malicious = max(0.91, 0.03, 0.01) = 0.91
  reputation = get_reputation("paypa1-secure.tk") = 0.0 (unknown)
  
  Tier Check:
  â”œâ”€ 0.91 â‰¥ 0.93? NO (not Tier 1)
  â”œâ”€ 0.91 â‰¥ 0.75? YES (Tier 2A)
  â””â”€ reputation â‰¥ 0.95? NO (not elite)
  
  DECISION: BLOCK (Tier 2A, no elite protection)

STEP 9: Final Output
  {
    "prediction": "phishing",
    "confidence": 0.91,
    "risk_level": "high",
    "tier": "tier_2a",
    "inference_time_ms": 47
  }


TRAINING PROCESS (v7):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. DATA LOADING
   â”œâ”€ Load 641,191 URLs from Kaggle dataset
   â”œâ”€ Remove duplicates
   â””â”€ Stratified split (80% train/20% test)
   â””â”€ Result: 512,966 train / 128,225 test

2. DUAL PREPROCESSING
   â”œâ”€ URL Processing:
   â”‚  â”œâ”€ Lowercase conversion
   â”‚  â”œâ”€ Character vocabulary (101 chars)
   â”‚  â”œâ”€ Integer encoding
   â”‚  â””â”€ Padding/truncation to 200 chars
   â”‚
   â””â”€ Domain Processing:
      â”œâ”€ URL parsing (extract netloc)
      â”œâ”€ Same character encoding
      â””â”€ Padding/truncation to 100 chars

3. CLASS WEIGHT CALCULATION
   â”œâ”€ Benign:      weight = 0.375 (66.76% of data)
   â”œâ”€ Defacement:  weight = 1.663 (15.04% of data)
   â”œâ”€ Phishing:    weight = 1.706 (14.68% of data)
   â””â”€ Malware:     weight = 7.115 (3.51% of data)

4. DUAL-INPUT MODEL TRAINING
   â”œâ”€ Batch size: 128
   â”œâ”€ Epochs: 30 (trained to convergence)
   â”œâ”€ Optimizer: Adam (lr=0.001)
   â”œâ”€ Loss: Categorical cross-entropy (class-weighted)
   â”œâ”€ Callbacks:
   â”‚  â”œâ”€ ModelCheckpoint (save best @ epoch 27)
   â”‚  â”œâ”€ EarlyStopping (patience=5, not triggered)
   â”‚  â””â”€ ReduceLROnPlateau (factor=0.5, patience=3)
   â”œâ”€ Validation: 20% of training data
   â””â”€ Training Time: ~45 minutes (CPU)

5. BASE MODEL EVALUATION
   â”œâ”€ Test Accuracy: 98.50%
   â”œâ”€ Test Loss: 0.00411
   â”œâ”€ Confusion matrix analysis
   â”œâ”€ Per-class metrics
   â””â”€ Visualization generation

6. v7 ENHANCEMENT DEVELOPMENT
   â”œâ”€ 4-tier threshold optimization
   â”œâ”€ Reputation system integration
   â”œâ”€ Validation testing (50 brands + 15 malicious)
   â”œâ”€ FP rate: 4.0% vs target <5% âœ“
   â””â”€ Detection rate: 100% vs target >95% âœ“

7. STRESS TESTING
   â”œâ”€ Temporal stability (1.63% degradation)
   â”œâ”€ Adversarial attacks (200 samples, 94% detection)
   â”œâ”€ TLD distribution testing
   â””â”€ Production readiness validation


WHY v7 DUAL-INPUT ARCHITECTURE WORKS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ DUAL-INPUT DESIGN (URL + DOMAIN)
  - URL branch: Learns full path, query, fragment patterns
  - Domain branch: Focuses on brand mimicry, typosquatting
  - Complementary features: Captures different threat aspects
  - Better generalization than single-input models

âœ“ SEPARATE EMBEDDING LAYERS
  - URL embeddings: Learn character roles in full URLs
  - Domain embeddings: Learn character roles in domains
  - Shared vocabulary (101 chars): Efficient memory
  - 128-dimensional: Rich representation space

âœ“ ASYMMETRIC BRANCH ARCHITECTURE
  - URL branch (256â†’128â†’64): More capacity for complex patterns
  - Domain branch (128â†’64â†’32): Focused on domain-specific patterns
  - Reflects URL complexity > domain complexity
  - Optimized parameter distribution

âœ“ MULTI-SCALE KERNEL SIZES (3, 5, 7)
  - Kernel 3: Character-level patterns ("tk", "ml", "ga")
  - Kernel 5: Short word patterns ("login", "admin")
  - Kernel 7: Longer patterns ("password", "phishing")
  - Hierarchical feature extraction

âœ“ CONCATENATION FUSION
  - Late fusion: Both branches learn independently
  - 96-dimensional combined features (64+32)
  - Dense layers learn cross-stream interactions
  - More robust than early fusion

âœ“ STRONG REGULARIZATION
  - Dropout 0.3 (conv layers): Prevents feature co-adaptation
  - Dropout 0.5 (dense layers): Stronger regularization
  - L2 penalty (0.001): Weight decay
  - No overfitting: Val accuracy > Train accuracy

âœ“ v7 ENHANCEMENT LAYER (POST-PROCESSING)
  - 4-tier decision logic: Nuanced blocking strategy
  - Reputation system: Protects elite brands (FP reduction)
  - Tier 1 (â‰¥93%): High-confidence threats (always block)
  - Tier 2A/2B (35-93%): Reputation-based (elite protection)
  - Tier 3 (<35%): Low confidence (allow benign)
  - Explainable decisions: Tier + reputation + confidence

âœ“ EFFICIENT INFERENCE
  - 424K parameters: Compact model
  - 40-50ms latency: Real-time capable
  - CPU-friendly: No GPU required
  - Scalable: Stateless horizontal scaling


KEY DESIGN PRINCIPLES (v7):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. MULTI-STREAM FEATURE EXTRACTION
   Parallel processing: URL stream + Domain stream
   Hierarchical: Characters â†’ N-grams â†’ Patterns â†’ Features
   Late fusion: Independent learning + combined decision

2. REGULARIZATION AT EVERY LEVEL
   Embedding â†’ Dropout(0.3) â†’ Conv â†’ Dropout(0.3) â†’ Dense â†’ Dropout(0.5)
   L2 penalty on dense layers
   Result: No overfitting (val_acc > train_acc)

3. BALANCED COMPLEXITY
   424K parameters: Not too simple, not too complex
   Multi-input: Captures diverse patterns
   Efficient: Fast inference (47ms average)

4. CLASS IMBALANCE HANDLING
   Class-weighted loss: 0.375 (benign) to 7.115 (malware)
   Stratified splits: Maintain class ratios
   Result: 94-99% per-class performance

5. FALSE POSITIVE MITIGATION (v7 ENHANCEMENT)
   Base model: 98.5% accuracy, 0.67% FP rate
   v7 layer: 4-tier logic + reputation system
   Result: 4.0% FP rate, 100% detection
   Elite protection: Top brands never blocked

6. PRODUCTION READINESS
   Standardized JSON output
   Configurable logging
   Error handling
   Batch processing support
   CLI + Python API

7. EXPLAINABILITY & MONITORING
   Confidence scores: How certain is the model?
   Tier decisions: Which threshold triggered?
   Reputation scores: Is domain trusted?
   Entropy: Measure of prediction uncertainty
   Inference time: Performance tracking

v7 PERFORMANCE SUMMARY:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š TEST SET METRICS:
   â”œâ”€ Accuracy:          98.50%
   â”œâ”€ Test Loss:         0.00411
   â”œâ”€ Precision (avg):   98.33%
   â”œâ”€ Recall (avg):      97.08%
   â””â”€ F1-Score (avg):    97.69%

ğŸ“Š PER-CLASS PERFORMANCE:
   â”œâ”€ Benign:       99.11% F1 (85,616 samples)
   â”œâ”€ Defacement:   99.63% F1 (19,062 samples)
   â”œâ”€ Malware:      97.11% F1 (4,729 samples)
   â””â”€ Phishing:     94.90% F1 (18,818 samples)

ğŸ“Š v7 ENHANCEMENT VALIDATION:
   â”œâ”€ False Positive Rate:  4.0% (2/50 brands)
   â”œâ”€ Detection Rate:       100% (15/15 malicious)
   â”œâ”€ Avg Inference Time:   47ms
   â””â”€ Status:               Production Ready âœ“

ğŸ“Š STRESS TESTING:
   â”œâ”€ Temporal Degradation: 1.63% (excellent stability)
   â”œâ”€ Adversarial Detection: 94% (188/200 attacks)
   â”œâ”€ TLD Coverage:         97.9% (high-risk TLDs)
   â””â”€ Domain Coverage:      30,000+ domains tested

ğŸ“Š PRODUCTION DEPLOYMENT (Feb 15, 2026):
   â”œâ”€ Model:         models/production/model_v7.h5
   â”œâ”€ Size:          13.3 MB
   â”œâ”€ Parameters:    424,132
   â”œâ”€ CLI:           main.py
   â”œâ”€ API:           src/inference.py
   â””â”€ Status:        âœ… DEPLOYED & VALIDATED

================================================================================
